<div class="h-screen bg-neural-void flex overflow-hidden relative">
  <!-- グローバルグリッド背景 -->
  <div class="absolute inset-0 opacity-5">
    <div
      class="absolute inset-0"
      style="
        background-image: radial-gradient(
            circle at 20% 50%,
            rgba(0, 217, 255, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 80%,
            rgba(124, 58, 237, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 40% 20%,
            rgba(0, 255, 136, 0.1) 0%,
            transparent 50%
          );
      "
    ></div>
  </div>
  <!-- サイドバー -->
  <div
    class="transition-all duration-300"
    [class.w-64]="!isSidebarCollapsed()"
    [class.w-0]="isSidebarCollapsed()"
    [class.overflow-hidden]="isSidebarCollapsed()"
  >
    <app-sidebar
      (newChatCreated)="onNewChat()"
      (sessionSelected)="onSessionSelected($event)"
    >
    </app-sidebar>
  </div>

  <!-- メインコンテンツ -->
  <div class="flex-1 flex flex-col">
    <!-- ヘッダー -->
    <header
      class="h-16 bg-neural-dark/80 backdrop-blur-xl border-b border-neural-border flex items-center px-6 relative z-20"
    >
      <!-- ヘッダーグローライン -->
      <div
        class="absolute inset-x-0 -bottom-px h-px bg-gradient-to-r from-transparent via-accent-neon/50 to-transparent"
      ></div>
      <button
        (click)="toggleSidebar()"
        class="p-2.5 hover:bg-neural-surface rounded-lg transition-all duration-300 mr-4 group hover:shadow-inner-glow"
      >
        <svg
          class="w-5 h-5 text-neural-subtle transition-colors duration-300 group-hover:text-accent-neon"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"
          ></path>
        </svg>
      </button>

      <div class="flex items-center gap-3">
        <span
          class="w-10 h-10 bg-gradient-to-br from-accent-neon to-accent-quantum rounded-lg flex items-center justify-center shadow-neon-sm relative overflow-hidden group"
        >
          <div
            class="absolute inset-0 bg-gradient-to-br from-accent-electric to-accent-plasma opacity-0 group-hover:opacity-100 transition-opacity duration-500"
          ></div>
          <svg
            class="w-6 h-6 text-neural-dark relative z-10"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2.5"
              d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
            ></path>
          </svg>
        </span>
        <div class="flex flex-col">
          <h1 class="text-lg font-bold text-neural-bright">{{ title }}</h1>
          <span class="text-xs text-neural-muted font-mono"
            >Neural Interface v2.0</span
          >
        </div>
      </div>

      <div class="flex-1"></div>

      <!-- ステータスインジケーター -->
      <div class="flex items-center gap-3 mr-4">
        <div
          class="flex items-center gap-2 px-3 py-1.5 bg-neural-surface rounded-lg border border-neural-border"
        >
          <div
            class="w-2 h-2 bg-accent-electric rounded-full animate-pulse"
          ></div>
          <span class="text-xs text-neural-subtle font-mono">Connected</span>
        </div>
        <div
          class="px-3 py-1.5 bg-neural-surface rounded-lg border border-neural-border"
        >
          <span class="text-xs text-neural-subtle font-mono"
            >{{ getCurrentTime() }}</span
          >
        </div>
      </div>

      <div class="flex items-center gap-2">
        <button
          (click)="openCommandPalette()"
          class="px-4 py-2 text-xs text-neural-muted bg-neural-surface/50 rounded-lg hover:bg-neural-surface hover:text-accent-neon border border-neural-border transition-all duration-300 flex items-center gap-2 font-mono group hover:shadow-inner-glow"
        >
          <svg
            class="w-4 h-4 transition-transform duration-300 group-hover:scale-110"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"
            ></path>
          </svg>
          <span>Cmd+K</span>
        </button>
      </div>
    </header>

    <!-- チャットエリア -->
    <div class="flex-1 p-6 overflow-hidden flex flex-col relative z-10">
      <div
        class="flex-1 bg-neural-darker/50 backdrop-blur-xl rounded-xl shadow-2xl border border-neural-border relative flex flex-col overflow-hidden group"
      >
        <!-- ネオングロー効果 -->
        <div
          class="absolute inset-0 rounded-xl bg-gradient-to-br from-glow-neon via-transparent to-glow-plasma opacity-0 group-hover:opacity-100 transition-opacity duration-1000 pointer-events-none"
        ></div>
        <!-- ボーダーグロー -->
        <div
          class="absolute inset-0 rounded-xl shadow-inner-glow pointer-events-none"
        ></div>
        <app-chat
          class="relative z-10 flex-1 flex flex-col overflow-hidden"
        ></app-chat>
      </div>
    </div>
  </div>
</div>
<router-outlet></router-outlet>

<!-- コマンドパレット -->
<app-command-palette></app-command-palette>
