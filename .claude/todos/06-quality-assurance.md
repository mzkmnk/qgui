# フェーズ 6: 品質保証 - 機能単位 TDD 実装

## 概要

YAGNI原則に従い、基本的な品質保証のみを実施する。
複雑なテスト戦略は実際に品質問題が発生してから検討する。

## 基本的な品質保証

### 1. 既存テストの維持（継続的）

#### 1.1 Red→Greenサイクルで作成したテスト

- [ ] **維持**: 各機能実装時に作成したテストが全てGreen
- [ ] **実行**: `npm run test` でフロントエンド・バックエンド両方のテスト実行
- [ ] **修正**: 壊れたテストがあれば修正

### 2. 基本的なリグレッションテスト（PR作成時）

#### 2.1 手動確認項目

- [ ] **基本動作確認**: 
  - [ ] コマンド入力→実行→結果表示が動作
  - [ ] WebSocket接続が確立される
  - [ ] ANSIカラー（赤色）が表示される
- [ ] **エラーなし確認**:
  - [ ] ブラウザコンソールにエラーなし
  - [ ] バックエンドログにエラーなし

### 3. 最小限のE2Eテスト（リリース前のみ）

#### 3.1 基本フローの確認

- [ ] **条件**: 大きな変更後やリリース前のみ実施
- [ ] **テスト内容**: 
  ```typescript
  // 最小限のE2Eテスト例
  it('基本的なコマンド実行ができる', async () => {
    await page.goto('http://localhost:4200');
    await page.fill('[data-testid="command-input"]', 'echo test');
    await page.keyboard.press('Enter');
    await expect(page.locator('[data-testid="output"]')).toContainText('test');
  });
  ```

## 削除した項目（YAGNI原則）

以下の項目は実際に必要になるまで実装しない：

**テスト戦略**
- テストカバレッジ80%目標（必要になるまで）
- 詳細なテストメトリクス収集
- テスト品質スキーマ定義
- パフォーマンステスト
- 負荷テスト
- セキュリティテスト
- アクセシビリティテスト

**高度なテスト**
- 複雑な統合テスト
- ユーザージャーニーE2Eテスト
- Visual Regression Test
- Mutation Testing
- Contract Testing
- Chaos Engineering

**テストインフラ**
- テストダブルの複雑な実装
- カスタムテストフレームワーク
- テストレポーティングシステム
- CI/CDパイプラインの複雑な設定
- 自動テスト実行環境

**品質メトリクス**
- コード品質の詳細な測定
- 循環的複雑度の測定
- 技術的負債の追跡
- 品質ダッシュボード

## 品質保証の基本方針

### 問題が発生してから対処する

1. **バグが見つかったら**
   - バグを再現するテストを書く（Red）
   - バグを修正する（Green）
   - リファクタリングする（必要なら）

2. **品質が低下したと感じたら**
   - 具体的な問題を特定する
   - その問題に対するテストを追加する
   - 最小限の改善を行う

## 各PRの完了条件

- [ ] 既存のテストが全てGreen
- [ ] 新機能には対応するテストがある
- [ ] 基本的な手動確認完了
- [ ] リント・型チェックエラーなし

## 重要な注意事項

- **過剰なテストは避ける** - 100%カバレッジは目指さない
- **実用的なテストに集中** - 壊れやすい箇所を重点的に
- **テストの保守性を重視** - 複雑なテストは避ける
- **手動テストも活用** - 全てを自動化する必要はない