# フェーズ 8: WebSocket-PTY 統合（コア機能で実装済み）

## 概要

WebSocket と PTY の基本的な統合は、フェーズ 2（コア機能）で既に実装済み。
追加の統合機能は、実際に必要になった場合のみ実装する。

## 実装済みの統合機能

### 基本的な統合（Phase 2 で実装）

- [x] **WebSocket 経由のコマンド送信**: クライアントからのコマンドを PTY に転送
- [x] **PTY 出力の WebSocket 送信**: PTY の出力をクライアントに送信
- [x] **基本的なエラーハンドリング**: 接続エラー、プロセスエラーの処理

## 必要に応じて実装する項目

### 1. 高度な統合機能（必要になった場合のみ）

- [ ] **条件**: 現在の統合で問題が発生した場合
  - [ ] チャットウィンドウの動的サイズ変更（リサイズ時）
  - [ ] 特殊キー処理（Ctrl+C 等）
  - [ ] セッション永続化

### 2. パフォーマンス改善（遅延が問題になった場合のみ）

- [ ] **条件**: 通信遅延が体感できる場合
  - [ ] メッセージバッファリング
  - [ ] 出力のスロットリング

## 削除した項目（YAGNI 原則）

以下の項目は実際に必要になるまで実装しない：

**高度な PTY 管理**

- node-pty の詳細な設定
- プラットフォーム固有の最適化
- プロセスプール管理
- CPU・メモリ使用量監視
- 自動再起動機能

**高度な統合機能**

- 複数 PTY セッション管理
- コマンドラインエミュレーション対応
- シェル選択機能
- 環境変数の詳細管理

**セキュリティ強化**

- PTY コマンドの詳細なフィルタリング
- サンドボックス実行
- リソース制限

## 実装方針

### 問題が発生してから対処

1. **現在の統合で十分か確認**

   - 基本的なコマンド実行が動作すれば十分
   - 特殊な要件がない限り追加実装は不要

2. **問題が発生した場合**
   - 具体的な問題を特定
   - 最小限の修正で解決
   - 過度な一般化は避ける

## 統合動作の確認項目

- [ ] WebSocket でコマンドを送信できる
- [ ] PTY でコマンドが実行される
- [ ] 結果が WebSocket 経由で返ってくる
- [ ] 基本的なエラーが処理される
